## mako
<%namespace name='static' file='static_content.html'/>
<%!
    from django.utils.translation import ugettext as _
    from django.core.urlresolvers import reverse
    import datetime
    import pytz

    def time_left(start):
        tz = pytz.timezone('Asia/Karachi')

        start = start.astimezone(tz)
        now = datetime.datetime.now(tz=tz)
        td = start - now
        hours = int(td.seconds // (60 * 60))
        mins = int((td.seconds // 60) % 60)

        d_string = "days" if td.days > 1 else "day"
        h_string = "hours" if hours > 1 else "hour"
        m_string = "minutes" if mins > 1 else "minute"

        days_msg = "{} {}".format(td.days, d_string) if td.days > 0 else ""
        hours_msg = "{} {}".format(hours, h_string) if hours > 0 else ""
        mints_msg = "{} {}".format(mins, m_string) if m_string > 0 else ""

        message = "Test starts in {} {} {}".format(
            days_msg, hours_msg, mints_msg
        )

        return message

%>
    <%page args="course" expression_filter="h"/>
    <article class="course" id="${course.id}" role="region" aria-label="${course.display_name_with_default}">
        <a href="/login">
            <header class="course-image">
                <div class="cover-image">
                    <img src="${course.course_image_url}" alt="${course.display_name_with_default} ${course.display_number_with_default}" />
                    <div class="learn-more" aria-hidden=true>${_("LEARN MORE")}</div>
                </div>
            </header>
            <div class="course-info" aria-hidden="true">
                <h2 class="course-name">
                    <span class="course-organization">${course.display_org_with_default}
                        <span class="course-date pull-right" aria-hidden="true">
                            <i class="fa fa-clock-o" aria-hidden="true"></i> ${time_left(course.start)}
                        </span>
                    </span>
                    <span class="course-title">${course.display_name}</span>
                    <a href="/login" class="btn btn-brand">Enroll</a>
                </h2>

            </div>
            <div class="sr">
                <ul>
                    <li>${course.display_org_with_default}</li>
                    <li>${course.display_name}</li>
                    <li>${_("Starts")}: <time itemprop="startDate" datetime="${course.start_datetime_text()}">${course.start_datetime_text()}</time></li>
                </ul>
            </div>
        </a>
    </article>
